---
layout: page
number: 68
---
棒 $$ i $$ を $$ P_i $$ 分割して合計で $$ k $$ 本の棒を作れるとする. このとき $$ k + 1 $$ 本の棒を作るためには, $$ k $$ 本に分割したときの分割方法からどれか1つを選び分割数を1増やすことになり, 選ぶ棒は分割数を1増やしたときに取れる長さが最大の棒になる.

優先順位付きキューに (棒の長さ, 現在の分割数, 分割数を1増やしたときの長さ) の組を入れておき, 分割数を1増やしたときの長さが大きい組を取り出して, 分割数と分割数を1増やしたときの長さを更新していく.

これを $$ 1 \dots \max(K_i) $$ まで計算しておけばいい.
