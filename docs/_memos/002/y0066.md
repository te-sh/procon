---
number: 66
---
$$ i $$ 番目の人が $$ j $$ 回戦を勝ち抜く確率を $$ p(i, j) $$ とし, $$ i $$ 番目の人が $$ j $$ 番目の人に勝つ確率を $$ q(i, j) $$ とすると,

$$
q(i, j) = \frac{S_i^2}{S_i^2 + S_j^2}
$$

$$
p(i, j) = p(i, j - 1) \sum_{k \in T} q(i, k) \cdot p(k, j - 1)
$$

となる. ただし, $$ T $$ は $$ i $$ 番目の人が $$ j $$ 回戦で対戦する可能性のある相手の集合である.

これを1回戦から順に計算し, $$ p(0, M) $$ を見る.
