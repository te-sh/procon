---
layout: page
number: 229
---
$$ P_1 $$ と $$ P_2 $$ が同じ向きで出会うときは, $$ P_1 $$ と $$ P_2 $$ の動いた距離の差が $$ 2kL $$ となるので, 出会う時刻は

$$
\begin{align}
t_1 &= \frac{2kL}{\frac{2L}{T_1} - \frac{2L}{T_2}} \\
    &= \frac{2kT_1T_2}{T_2 - T_2}
\end{align}
$$

となり, $$ P_1 $$ と $$ P_2 $$ が逆向きで出会うときは, $$ P_1 $$ と $$ P_2 $$ の動いた距離の和が $$ 2kL $$ となるので, 出会う時刻は

$$
\begin{align}
t_2 &= \frac{2kL}{\frac{2L}{T_1} + \frac{2L}{T_2}} \\
    &= \frac{2kT_1T_2}{T_2 + T_1}
\end{align}
$$

となる.

あとは $$ P_1, P_2, P_3 $$ のうちの2点が同じ向きか逆向きのどちらで出会うかを全探索し, $$ (P_1, P_2), (P_2, P_3), (P_3, P_1) $$ が出会う時刻の最小公倍数を求めてその最小値を取ればいい.

なお, 分数の最小公倍数は, 通分して分子の最小公倍数を計算する.
