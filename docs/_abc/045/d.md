---
number: '045'
problem: D
problem_path: arc061_b
---
塗るマスは行の昇順かつ同じ行なら列の昇順にソートしておく.

$$ 3 \times 3 $$ の正方形内に $$ j $$ 個塗られたマスがある正方形の数をカウンタとして持っておく. 初期値は $$ j = 0 $$ のとき $$ (H-2)(W-2) $$ である.

そして, ひとつずつ塗るマスを見ていき, 塗るマスを含む $$ 3 \times 3 $$ の正方形内にそれ以前にいくつ塗られたマスがあるかどうかを数える. 塗るマスはソート済なので二分探索が使える. それ以前に塗られたマスの数のカウンタをひとつ減らし, それ以前に塗られたマスの数+1のカウンタをひとつ増やす.
