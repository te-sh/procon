---
number: 620
---
平面を複素平面で表してみる. そうすると, 元の計算式は次のようになる.

$$
z_{t+1} = ((1+v) + \omega i)z_t + u_t
$$

$$ c = ((1+v) + \omega i) $$ とおくと, 時刻 $$ T $$ の位置は,

$$
z_T = c^T + c^{T-1}u_0 + c^{T-2}u_1 + \dots + u_{T-1}
$$

となる. 時刻 $$ T $$ で $$ g_x + g_yi $$ にいればいいので, $$ a_t = c^{T-1-t} $$, $$ b = (g_x + g_yi) - c^T $$ とおくと,

$$
a_0u_0 + a_1u_1 + \dots + a_{T-1}u_{T-1} = b
$$

となる.

ここで, $$ a = (a_0, a_1, \dots, a_{T-1}), u = (u_0, u_1, \dots, u_{T-1})^T $$ とおくと,

> $$ au = b $$ のもとで $$ \| u \|^2 $$ を最小化する

という問題となる. ただし, ノルムはL2ノルムである.

これは, $$ a $$ の一般逆行列 $$ a^{\dagger} $$ を求めると,

$$
u = a^{\dagger} b
$$

となる. ベクトルの一般逆行列は,

$$
a^{\dagger} = \frac{1}{\| a \|^2} a^{*}
$$

で表せる. ただし, $$ a^{*} $$ は $$ a $$ の随伴行列 (転置して複素共役を取ったもの) である. したがって,

$$
u = \frac{b}{\| a \|^2} a^{*}
$$

となる. 原点から平面に下ろした垂線の足というイメージを複素空間に拡張した感じかな.
