---
number: 631
---
横軸を時刻, 縦軸を駅としたグラフを描いてみると, 下のようになる.

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="468px" height="338px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&quot; version=&quot;7.9.5&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;6373a6ec-33e9-a132-3702-18d05d69fed5&quot; name=&quot;Page-1&quot;&gt;7Vldk5owFP01vDokIODjarftS2d2Zh+6fYxwhcwicWJctb++iYRvELEyrp3uww45gZvknEPuDRrWYn34xskm+sECiA1sBgfD+mJg7HqO/K+AowaQlQIhp0EKoQJ4pb9Bg6ZGdzSAbeVGwVgs6KYK+ixJwBcVjHDO9tXbViyujrohITSAV5/ETfQnDUSUoh52C/w70DDKRkbOLO1ZEv895GyX6PEMbK1Of2n3mmSx9EK3EQnYvgRZz4a14IyJ9Gp9WECsqM1oS5/72tGbz5tDIi55QMvyQeIdZDM+zUscMy4gCZ4UpbLlx2S7pb5hzSOxjiWA5OWKJUIriGzZTgNA0GC4mBPKVyoNBGwNgh/lLfuC6qnmJyqxnGEcYiLoRzU80YqHebh8hBdG5cDY1Ob0dBhtTcsxqxG2bMd90A+VqTsfx66FEYSHIBph5EVpzQV00qVdI/u/RtdqNMU9gW6n0rShkmjIJOAgqsJsBWfvsGAx4xJJWAJKLRrHNYjENEyUulIfkPj8A7igcsN60h1rGgRqmPk+ogJeN8RXY+7l7iyx04YEaqJmpxlUQDgMtUMXz5kPSnbBLXbBZrczKlqcId7tfz2q629jqPdd+St66nbGTXa8FnbqW8o17HgPx07eLrGD2sxzC3pmj0eP3UKPORI9WT32SPyYbVvPWPygh+MHOS3+scfiB/fzU6pddLI7wwccqHhTjYkpjxRp+5eidjKTGThtvwCncqYqTab5rpROZT0eEPBWfiP3yh7H92C5ynuyyt8aUDDJlZ1Kk1JqulcNlb+8WdapC3ppEYU8uz193b6IQsPOI5f7xZx47rTkF+mfMe0iTcGPb3pOp0Z5UNWuj3qdwXR2TwUoQffyHHJR1SqOe6XnZjXPWeN5btj5qt9zNzWQNG5hmtuZqOwYZN7TMnlu7tpdLrVMY7+z8GiWaR72PpFlpEMalsH/lmfsjpp4sGfcWqDxvg8g5xN65lLx7yZ01+FnqNAW7qiCRxD6gg8SZ4VuytQj/crzwW+VfulN7emQt/xuQvd9qLu/0LJZfJdPby9++7Ce/wA=&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><path d="M 7 327 L 7 13.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 7 8.12 L 10.5 15.12 L 7 13.37 L 3.5 15.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 7 327 L 440.63 327" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 445.88 327 L 438.88 330.5 L 440.63 327 L 438.88 323.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(454.5,319.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="4" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 4px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">t</div></div></foreignObject><text x="2" y="14" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">t</text></switch></g><rect x="7" y="287" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="7" y="247" width="120" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="7" y="207" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="7" y="167" width="200" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="7" y="127" width="140" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 88 324 L 111 287" fill="none" stroke="#6c8ebf" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 112 289 L 127 289" fill="none" stroke="#6c8ebf" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 127 287 L 168 209" fill="none" stroke="#6c8ebf" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 167 207 L 208 208" fill="none" stroke="#6c8ebf" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 207 207 L 247 127" fill="none" stroke="#6c8ebf" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 147 327 L 247 127" fill="none" stroke="#b85450" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/></g></svg>

各駅の始発電車の時刻を横幅とした長方形を置くと, 青線のように移動してもいいが, 赤線のように移動しても駅 $$ N $$ に着く時刻は変わらない.

すなわち, $$ T_i-3(i-1) $$ の最大値の時間だけ駅1で待機すれば後はすべての駅で待機することなく駅 $$ N $$ に着くことができるということになる.

あとは最大値を求める遅延伝播付きのセグメントツリーに $$ T_i-3(i-1) $$ を入れておき, 電車遅延が発生するごとに全区間の最大値を求めていけばいい.
